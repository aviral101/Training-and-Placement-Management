{% extends "includes/index.html" %}
{% include 'includes/messages.html' %}

{% load bulma_tags %}
{% load static %}
<link href="{% static '/css/styles.css' %}" rel="stylesheet">
<title>{% block title%}Statistics{% endblock %}</title>
{% block content %}
<br>
<h1 class="title has-text-centered">Companies Recruiting</h1>
<div class="tile is-ancestor">
    <div class="tile is-6 is-vertical is-parent">
        <div class="tile is-child box">
            <canvas id="horizontalBarChartCanvas"></canvas>
        </div>
    </div>
    <div class="tile is-parent">
        <div class="tile is-child box">
            <p class="title has-text-centered">Highest & Average Package </p>
            <div>
                <canvas id="barChart"></canvas>
            </div>
        </div>
    </div>
</div>
<div class="field is-grouped is-pulled-right">
    <p class="control">
        <a href="{{ st.0.report.url }}" download="{{ st.0.report.url }}" download>
            <button class="button is-light " style="background-color: rgba(105, 0, 255, 0.11);color: #6900FF;">
                <strong>
    
                    Placement Report {{ st.0.year }}
                </strong>
            </button>
        </a>
    </p>
    <p class="control">
        <a href="{{ st.1.report.url }}" download="{{ st.1.report.url }}" download>

            <button class="button is-primary is-light">
                <strong>

                    Placement Report {{ st.1.year }}
                </strong>

            </button>
        </a>

    </p>
    <p class="control">
        <a href="{{ st.2.report.url }}" download="{{ st.2.report.url }}" download>

            <button class="button is-danger is-light">
                <strong>

                    Placement Report {{ st.2.year }}
                </strong>

            </button>
        </a>
    </p>
</div><br>
<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.bundle.js'></script><br>
<section class="section">
    <div class="container has-text-centered">
        <h1 class="title">
            STATISTICS
        </h1>
        <br>
    </div>
    <div class="tabs is-fullwidth is-toggle ">
        <div class="container">
            <ul>
                <li class="tab is-active" onclick="openTab(event,'WebDev')"><a>{{ st.0.year }}</a></li>
                <li class="tab" onclick="openTab(event,'WebAud')"><a>{{ st.1.year }}</a></li>
                <li class="tab" onclick="openTab(event,'Support')"><a>{{ st.2.year }}</a></li>
            </ul>
        </div>
    </div>
</section>
<div class="container section ml-6">
    <div id="WebDev" class="content-tab">
        <div class="columns is-mobile">
            <div class="column">BRANCHES</div>
            <div class="column">TOTAL</div>
            <div class="column">PLACED</div>
            <div class="column">PERCENTAGE</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">CS</div>
            <div class="column title" data-count="{{ st.0.cs_total }}">0</div>
            <div class="column title" data-count="{{ st.0.cs }}">0</div>
            <div class="column title" data-count="{% widthratio st.0.cs st.0.cs_total 100 %}">0</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">IT</div>
            <div class="column title" data-count="{{ st.0.it_total }}">0</div>
            <div class="column title" data-count="{{ st.0.it }}">0</div>
            <div class="column title" data-count="{% widthratio st.0.it st.0.it_total 100 %}">0</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">EXTC</div>
            <div class="column title" data-count="{{ st.0.extc_total }}">0</div>
            <div class="column title" data-count="{{ st.0.extc }}">0</div>
            <div class="column title" data-count="{% widthratio st.0.extc st.0.extc_total 100 %}">0</div>
        </div>
    </div>
    <div id="WebAud" class="content-tab" style="display:none">
        <div class="columns is-mobile">
            <div class="column">BRANCHES</div>
            <div class="column">TOTAL</div>
            <div class="column">PLACED</div>
            <div class="column">PERCENTAGE</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">CS</div>
            <div class="column title" data-count="{{ st.1.cs_total }}">0</div>
            <div class="column title" data-count="{{ st.1.cs }}">0</div>
            <div class="column title" data-count="{% widthratio st.1.cs st.1.cs_total 100 %}">0</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">IT</div>
            <div class="column title" data-count="{{ st.1.it_total }}">0</div>
            <div class="column title" data-count="{{ st.1.it }}">0</div>
            <div class="column title" data-count="{% widthratio st.1.it st.1.it_total 100 %}">0</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">EXTC</div>
            <div class="column title" data-count="{{ st.1.extc_total }}">0</div>
            <div class="column title" data-count="{{ st.1.extc }}">0</div>
            <div class="column title" data-count="{% widthratio st.1.extc st.1.extc_total 100 %}">0</div>
        </div>
    </div>
    <div id="Support" class="content-tab" style="display:none">
        <div class="columns is-mobile">
            <div class="column">BRANCHES</div>
            <div class="column">TOTAL</div>
            <div class="column">PLACED</div>
            <div class="column">PERCENTAGE</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">CS</div>
            <div class="column title" data-count="{{ st.2.cs_total }}">0</div>
            <div class="column title" data-count="{{ st.2.cs }}">0</div>
            <div class="column title" data-count="{% widthratio st.2.cs st.2.cs_total 100 %}">0</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">IT</div>
            <div class="column title" data-count="{{ st.2.it_total }}">0</div>
            <div class="column title" data-count="{{ st.2.it }}">0</div>
            <div class="column title" data-count="{% widthratio st.2.it st.2.it_total 100 %}">0</div>
        </div>
        <div class="columns is-mobile">
            <div class="column is-size-4">EXTC</div>
            <div class="column title" data-count="{{ st.2.extc_total }}">0</div>
            <div class="column title" data-count="{{ st.2.extc }}">0</div>
            <div class="column title" data-count="{% widthratio st.2.extc st.2.extc_total 100 %}">0</div>
        </div>
    </div>

    </section>
    <script src="{% static 'js/counter2.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
        crossorigin="anonymous"></script>
    <script src="{% static 'js/Chart.js' %}"></script>
    <script src="{% static 'js/ChartHorizontal.js' %}"></script>
    <script>
    Chart.defaults.global.defaultFontFamily = "Lato";

var horizontalBarChart = new Chart(horizontalBarChartCanvas, {
    type: 'horizontalBar',
    data: {
        labels: ["{{ st.0.year }}", "{{ st.1.year }}", "{{ st.2.year }}"],
        datasets: [{
            data: [{% widthratio st.0.company_visited 1 1000 %}, {% widthratio st.1.company_visited 1 1000 %}, {% widthratio st.2.company_visited 1 1000 %},],
            backgroundColor: ["#cc65fe", "#ff6384", "#36a2eb",],
        }]
    },
    options: {
        tooltips: {
            enabled: false
        },
        responsive: true,
        legend: {
            display: false,
            position: 'bottom',
            fullWidth: true,
            labels: {
                boxWidth: 20,
                padding: 50
            }
        },
        scales: {
            yAxes: [{
                barPercentage: 0.75,
                gridLines: {
                    display: true,
                    drawTicks: true,
                    drawOnChartArea: false
                },
                ticks: {
                    fontColor: '#555759',
                    fontFamily: 'Lato',
                    fontSize: 11
                }

            }],
            xAxes: [{
                gridLines: {
                    display: true,
                    drawTicks: false,
                    tickMarkLength: 4,
                    drawBorder: false
                },
                ticks: {
                    padding: 5,
                    beginAtZero: true,
                    fontColor: '#555759',
                    fontFamily: 'Lato',
                    fontSize: 11,
                    callback: function (label, index, labels) {
                        return label / 1000;
                    }

                },
                scaleLabel: {
                    display: true,
                    padding: 10,
                    fontFamily: 'Lato',
                    fontColor: '#555759',
                    fontSize: 16,
                    fontStyle: 700,
                    labelString: 'Company Visited'
                },

            }]
        }
    }
});
    </script>
    <script>
        var DEFAULT_DATASET_SIZE = 4,
	addedCount = 0,
	color = Chart.helpers.color;

var months = ["{{ st.0.year }}", "{{ st.1.year }}", "{{ st.2.year }}"];

var chartColors = {
	red: 'rgb(255, 99, 132)',
	orange: 'rgb(255, 159, 64)',
	yellow: 'rgb(255, 205, 86)',
	green: 'rgb(75, 192, 192)',
	blue: 'rgb(54, 162, 235)',
	purple: 'rgb(153, 102, 255)',
	grey: 'rgb(231,233,237)'
};

function randomScalingFactor() {
	return Math.round(Math.random() * 14);
}

var barData = {
	labels: ["{{ st.0.year }}", "{{ st.1.year }}", "{{ st.2.year }}" ],
	datasets: [{
		label: 'Highest Package',
		backgroundColor: color(chartColors.red).alpha(0.5).rgbString(),
		borderColor: chartColors.red,
		borderWidth: 1,
		data: [
			{{ st.0.highest_package }},
			{{ st.1.highest_package }},
			{{ st.2.highest_package }},
		]
	}, {
		label: 'Average Package',
		backgroundColor: color(chartColors.blue).alpha(0.5).rgbString(),
		borderColor: chartColors.blue,
		borderWidth: 1,
		data: [
			{{ st.0.average_package }},
			{{ st.1.average_package }},
			{{ st.2.average_package }},
		]
	}]

};
var index = 5;
var ctx = document.getElementById("barChart").getContext("2d");
var myNewChartB = new Chart(ctx, {
	type: 'bar',
	data: barData,
	options: {
		responsive: true,
		maintainAspectRation: true,
		legend: {
			position: 'top',
		},
		title: {
			display: true,
			text: '( Last 3 Years Trend )'
		}
	}
});
    </script>

    {% endblock %}